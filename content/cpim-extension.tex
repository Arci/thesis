\section{Introduction}
In this chapter will be presented the architecture of CPIM especially for the NoSQL service before this work, then will be explained haw was possible to include Kundera as persistence layer for the NoSQL service in CPIM and what problem has been faced during the process.
Furthermore in section \ref{sec:hegira} is shown how the integration with the migration system \textit{Hegira} has been introduced, what are the feature supported by this integration and which design choices has been put in place. 

\section{CPIM architecture}
\subsection{NoSQL support}

\section{Kundera integration}

\section{Hegira integration}
\label{sec:hegira}
\subsection{Intercepting CRUD operations}
\subsection{Intercepting queries}

\subsection{Build SQL statements}
\subsubsection{Build statements from objects}
\subsubsection{Build statements from JPQL queries}

\subsection{Migration Manager}
\subsubsection{Contacting the synchronization service}
\subsubsection{Handling the sequence numbers}
\section{Sending statements to Hegira}

\section{Summary}
